{"ast":null,"code":"var _jsxFileName = \"/Users/ivan/websites/react-chat-app/app/src/components/Chat.js\",\n    _s = $RefreshSig$();\n\nimport queryString from \"query-string\";\nimport { useEffect, useState } from \"react\";\nimport { socket } from \"../service/socket\";\nimport { ChatLink, CustomButton, Message, User } from \"./utils/index\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nexport function Chat() {\n  _s();\n\n  let [username, setUsername] = useState(\"\");\n  const [room, setRoom] = useState();\n  const [messages, setMessages] = useState([]);\n  const [users, setUsers] = useState([]);\n  const [message, setMessage] = useState(\"\"); //const room = localStorage.getItem(\"room\");\n\n  function getLink() {\n    const string = window.location.href;\n    const roomNumber = string.substring(string.indexOf(\"&\"));\n    const link = `${roomNumber}`;\n    return link;\n  }\n\n  let linkToChat = getLink(); //Get information about recieved messages and users in room\n\n  useEffect(() => {\n    const {\n      username,\n      room\n    } = queryString.parse(window.location.search);\n    setRoom(room);\n    setUsername(username);\n\n    function receivedMessage(message) {\n      setMessages([...messages, message]);\n    }\n\n    socket.on(\"message\", message => {\n      receivedMessage(message);\n    }); //Cancel subscribe. Solved problem of \"timeout violation\" and stucking messages.\n\n    return () => {\n      socket.off(\"message\");\n    };\n  }, [messages]);\n  socket.on(\"roomUsers\", ({\n    room,\n    users\n  }) => {\n    setUsers(users);\n    setRoom(room);\n  });\n\n  function sendMessage(e) {\n    e.preventDefault();\n    socket.emit(\"chatMessage\", message);\n    e.target.reset();\n  }\n\n  function handleChange(e) {\n    setMessage(e.target.value);\n  }\n\n  const Room = room => {\n    return /*#__PURE__*/_jsxDEV(\"h2\", {\n      id: \"room-name\",\n      children: room.room\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 59,\n      columnNumber: 12\n    }, this);\n  };\n\n  return users.length !== 0 ? /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"App\",\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"container\",\n      children: /*#__PURE__*/_jsxDEV(\"header\", {\n        className: \"row row-cols-2 border-bottom\",\n        children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n          className: \"flex-grow-1\",\n          children: \"Chat\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 66,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(CustomButton, {\n          name: \"Quit\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 67,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 65,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 64,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"container\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"row row-cols-1\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"row\",\n          children: [/*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"col col-2\",\n            children: /*#__PURE__*/_jsxDEV(\"aside\", {\n              children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n                children: \"Room Name:\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 75,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(Room, {\n                room: room\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 76,\n                columnNumber: 17\n              }, this), /*#__PURE__*/_jsxDEV(\"ul\", {\n                className: \"list-group list-group-flush\",\n                children: [\"Users:\", users.map((user, index) => {\n                  return /*#__PURE__*/_jsxDEV(User, {\n                    user: user\n                  }, index, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 80,\n                    columnNumber: 28\n                  }, this);\n                })]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 77,\n                columnNumber: 17\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 74,\n              columnNumber: 15\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 73,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"col chat_messages overflow-auto d-flex flex-column\",\n            children: messages.map((message, index) => {\n              return /*#__PURE__*/_jsxDEV(Message, {\n                message: message\n              }, index, false, {\n                fileName: _jsxFileName,\n                lineNumber: 87,\n                columnNumber: 24\n              }, this);\n            })\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 85,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 72,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"form\", {\n          id: \"chat-form\",\n          className: \"input-group mb-3\",\n          onSubmit: sendMessage,\n          children: [/*#__PURE__*/_jsxDEV(\"input\", {\n            id: \"msg\",\n            type: \"text\",\n            placeholder: \"Enter Message\",\n            required: true,\n            autoComplete: \"off\",\n            className: \"form-control flex-grow-2\",\n            onChange: handleChange\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 92,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n            className: \"btn btn-primary col-1 justify-self-end\",\n            children: \"Send\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 101,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 91,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 71,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(ChatLink, {\n        link: linkToChat\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 104,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 70,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 63,\n    columnNumber: 5\n  }, this) : /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"App\",\n    children: /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"container\",\n      children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n        className: \"flex-grow-1\",\n        children: \"Please go to Main page to input your name and select room\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 110,\n        columnNumber: 9\n      }, this), /*#__PURE__*/_jsxDEV(CustomButton, {\n        name: \"Go to Main\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 111,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 109,\n      columnNumber: 7\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 108,\n    columnNumber: 5\n  }, this);\n}\n\n_s(Chat, \"rGm4tF54cbhj1RhHBeowJzHcZ3M=\");\n\n_c = Chat;\n\nvar _c;\n\n$RefreshReg$(_c, \"Chat\");","map":{"version":3,"sources":["/Users/ivan/websites/react-chat-app/app/src/components/Chat.js"],"names":["queryString","useEffect","useState","socket","ChatLink","CustomButton","Message","User","Chat","username","setUsername","room","setRoom","messages","setMessages","users","setUsers","message","setMessage","getLink","string","window","location","href","roomNumber","substring","indexOf","link","linkToChat","parse","search","receivedMessage","on","off","sendMessage","e","preventDefault","emit","target","reset","handleChange","value","Room","length","map","user","index"],"mappings":"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","sourcesContent":["import queryString from \"query-string\";\nimport { useEffect, useState } from \"react\";\nimport { socket } from \"../service/socket\";\nimport { ChatLink, CustomButton, Message, User } from \"./utils/index\";\n\nexport function Chat() {\n  let [username, setUsername] = useState(\"\");\n  const [room, setRoom] = useState();\n  const [messages, setMessages] = useState([]);\n  const [users, setUsers] = useState([]);\n  const [message, setMessage] = useState(\"\");\n\n  //const room = localStorage.getItem(\"room\");\n\n  function getLink() {\n    const string = window.location.href;\n\n    const roomNumber = string.substring(string.indexOf(\"&\"));\n    const link = `${roomNumber}`;\n    return link;\n  }\n  let linkToChat = getLink();\n\n  //Get information about recieved messages and users in room\n  useEffect(() => {\n    const { username, room } = queryString.parse(window.location.search);\n    setRoom(room);\n    setUsername(username);\n\n    function receivedMessage(message) {\n      setMessages([...messages, message]);\n    }\n    socket.on(\"message\", (message) => {\n      receivedMessage(message);\n    });\n    //Cancel subscribe. Solved problem of \"timeout violation\" and stucking messages.\n    return () => {\n      socket.off(\"message\");\n    };\n  }, [messages]);\n\n  socket.on(\"roomUsers\", ({ room, users }) => {\n    setUsers(users);\n    setRoom(room);\n  });\n\n  function sendMessage(e) {\n    e.preventDefault();\n\n    socket.emit(\"chatMessage\", message);\n\n    e.target.reset();\n  }\n  function handleChange(e) {\n    setMessage(e.target.value);\n  }\n\n  const Room = (room) => {\n    return <h2 id=\"room-name\">{room.room}</h2>;\n  };\n\n  return users.length !== 0 ? (\n    <div className=\"App\">\n      <div className=\"container\">\n        <header className=\"row row-cols-2 border-bottom\">\n          <h2 className=\"flex-grow-1\">Chat</h2>\n          <CustomButton name={\"Quit\"} />\n        </header>\n      </div>\n      <div className=\"container\">\n        <div className=\"row row-cols-1\">\n          <div className=\"row\">\n            <div className=\"col col-2\">\n              <aside>\n                <h3>Room Name:</h3>\n                <Room room={room} />\n                <ul className=\"list-group list-group-flush\">\n                  Users:\n                  {users.map((user, index) => {\n                    return <User key={index} user={user} />;\n                  })}\n                </ul>\n              </aside>\n            </div>\n            <div className=\"col chat_messages overflow-auto d-flex flex-column\">\n              {messages.map((message, index) => {\n                return <Message key={index} message={message} />;\n              })}\n            </div>\n          </div>\n          <form id=\"chat-form\" className=\"input-group mb-3\" onSubmit={sendMessage}>\n            <input\n              id=\"msg\"\n              type=\"text\"\n              placeholder=\"Enter Message\"\n              required\n              autoComplete=\"off\"\n              className=\"form-control flex-grow-2\"\n              onChange={handleChange}\n            />\n            <button className=\"btn btn-primary col-1 justify-self-end\">Send</button>\n          </form>\n        </div>\n        <ChatLink link={linkToChat} />\n      </div>\n    </div>\n  ) : (\n    <div className=\"App\">\n      <div className=\"container\">\n        <h2 className=\"flex-grow-1\">Please go to Main page to input your name and select room</h2>\n        <CustomButton name={\"Go to Main\"} />\n      </div>\n    </div>\n  );\n}\n"]},"metadata":{},"sourceType":"module"}